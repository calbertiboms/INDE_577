# Multilayer Perceptron
## Overview

The Multilayer Perceptron is an extension of a single perceptron, and conforms a machine learning model that intends to solve complex problems by discovering patterns in data. The MLP is a type of feedforward artificial neural network and consists of:



*   An input layer: the layer that receives the input features.
*   Hidden layers: intermediate layers with neurons that process and transform inputs (giving weights, considering biases and activation functions).
*   An output layer: the last layer, which produces the final outcome. This final outcome can be a prediction for regression or classification.

MLP models are trained by adjusting weights to minimize the error between predictions and actual values. This concept of training is also known as backpropagation.

 MLP models are particularly powerful for non-linear relationships, and they have various applications in the industry, in different fields like forecastings, signal processing, NLP and gaming AI. 
 
 The idea for this project is to apply MLP for a forecasting problem. In this case, we intend to predict the power generation of a wind turbine based on different weather variables (humidity, temperature, among others), location, month and hour of the day.


---
## How the Multilayer Perceptron works

The structure of a MLP model is as follows (image from[ScienceDirect](https://www.sciencedirect.com/topics/computer-science/multilayer-perceptron)):

![Neural Network Diagram](https://ars.els-cdn.com/content/image/1-s2.0-S0925231223004502-gr1.jpg)

The key hyperparameters for this model are
* Number of hidden layers
* Number of neurons per layer
* Learning rate
* Activation functions
---
## Project Objectives

1. **Load  Wind Turbine Power Generation Forecasting Data**: Import a dataset from Kaggle with historic data from wind power generated.
2. **Preliminary Visual Analysis**: Explore possible features for the model and their correlation.
3. **Define features to predict the power generated per hour**: Select explanatory features that can help us to predict the power generated per hour.
4. **Build MLP model**: Build the MLP model, fit it and make predictions. Study performance.
5. **Tune hyperparameters**: Try different hyperparameters with **Keras Tuner**.
6. **Build MLP model with optimal hyperparameters**: Build the MLP model with the hyperparameters that achieved the best overall performance, fit it, make predictions and evaluate the model.
---
## Code Workflow
#### 1. Data Loading and Pre-Processing
* Load the dataset from Kaggle with zipfile and os.
* Open the dataset with pandas.
* Convert 'Time' column to datetime format and separate columns for date and hour.
```python
df['Time'] = pd.to_datetime(df['Time'], format='%d-%m-%Y %H:%M')
df['Month'] = df['Time'].dt.month  
df['Hour'] = df['Time'].dt.hour  
```
* Normalize features.
```python
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X_train = scaler.fit_transform(X_train)
X_test = scaler.transform(X_test)
```
#### 2. Preliminary Visual Analysis
* Use visualization libraries.
```python
import matplotlib.pyplot as plt
import seaborn as sns
from mpl_toolkits.mplot3d import Axes3D
```
* Build a correlation matrix.
* Construct a boxplot of power generated by month of the year.
* Make a boxplot of the power generated by hour of the day.
* Build boxplot of the power generated by location.
* Make a scatterplot of power generated based on wind speed at 10m and wind speed at 100m to visually detect possible colinearity.
* Make scatterplots for power vs. different variables. 

#### 3. Features for the model
* Based on the previous visual analysis, define explanatory features to predict the power generated per hour: wind speed at 100m, month, location and wind gust at 10m.

#### 4. MLP model
* Build MLP model with TensorFlow.
```python 
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import Adam
```
* Select hyperparameters
    *  2 hidden layers
    * 64 neurons per layer
    * learning rate 0.01
    * activation 'relu'
* Compile the model with 5 epochs and study accuracy, loss function and MAE.

#### 5. Hyperparameters - Keras Tuner
* Install Keras Tuner
```python 
!pip install keras-tuner -q
import kerastuner as kt
```
* Create a model-building function to allow Keras Tuner to test different configuration.
* Use tools like RandomSearch to run experiments with different combinations of hyperparameters (setting up the tuner).
* Run the tuner in the training the model with various configurations to identify the best-performing one based on a determined metric (in this case, the MAE).
#### 6. MLP model with optimal hyperparameters 
* Build and run the model with the optimal hyperparameters.
* Evaluate the model with r2 and MAE.
---
## Results
* We built a MLP model to predict the power generated per hour by a wind turbine based on four features. This first model had the following hyperparameters:

| Hyperparameter          | Value       |
|--------------------|-------------|
| Hidden Layers      | 2           |
| Neurons            | 64          |
| Learning Rate      | 0.01        |
* The model achieved an accuracy of 69.3% and a MAE of 0.104.

* We used Keras Tuner to find optimal hyperparameters. 
* We determined that the optimal hyperparameters were:

| Hyperparameter          | Value       |
|--------------------|-------------|
| Hidden Layers      | 1           |
| Neurons            | 32          |
| Learning Rate      | 0.01        |
* With this model, we achieved an accuracy of 70.7% and a MAE of 0.102. 


